✅ PARSING SPEC SHEET FOR REPLIT BUILDER
Use this as your implementation instructions.
Copy/paste into Replit so the builder will produce correct parsing + edge-case handling.

1. Input Format Requirements
The parser must accept:

PDF-extracted tables

CSV uploads

Image-to-text extracted tables (OCR inputs)

The table has fixed column order:

mathematica
Copy code
Description | Length | Width | Height | Weight | Lead TCN | PAX
Rules:

Column	Type	Notes
Description	string	May contain commas, slashes, parentheses
Length	int	Always numeric, inches
Width	int	Always numeric, inches
Height	int	Always numeric, inches
Weight	int	Always numeric, lbs
Lead TCN	string	Must preserve leading zeros, letters
PAX	int or empty	Only passenger rows OR totals

2. Parsing Rules
2.1 Cargo Rows
Cargo rows always have:

A string in Description

Numeric L/W/H/Weight fields

TCN string

Empty PAX field

2.2 PAX Rows
Rows with only the PAX column filled must be parsed as passenger entries:

Examples:

Description	Length	Width	Height	Weight	Lead TCN	PAX
(blank)						1

Rules:

Treat them as PAX entries, not cargo.

Add them to a passenger_entries: List[int]

Do NOT try to convert blanks in numeric columns.

2.3 Total Row
Final “30” row:

Must be parsed as total_pax = 30

Do not treat as individual passenger entries.

3. Edge Case Handling
3.1 Duplicate descriptions
Allowed. Do not collapse.

3.2 Missing TCN
If TCN is blank (rare):

Set as null

Continue parsing.

3.3 Trailing whitespace
Trim everything except inside TCN.

3.4 Allow commas inside description
Use intelligent CSV parsing, NOT split on commas.

4. Output Structure
Builder must produce:

json
Copy code
{
  "cargo": [
    {
      "description": "...",
      "length": 145,
      "width": 53,
      "height": 41,
      "weight": 4090,
      "lead_tcn": "FYSHP112S100080XX"
    }
  ],
  "pax_individual": [1, 1, 4, 4, 20],
  "pax_total": 30
}
5. Validation Rules
Cargo rows:
Reject rows if numeric fields contain non‑numeric text.

Reject rows if description missing but numbers present (avoid malformed rows).

PAX rows:
Must contain only one integer in last column.

6. 3D + Simulation Integration (optional but recommended)
Once parsed:

Auto‑tag rows where description contains "pallet" → palletized cargo

Auto‑tag rows where length > 120 or weight > 5000 → rolling stock

Provide flags:

json
Copy code
"is_rolling_stock": true/false,
"is_palletized": true/false
Builder must do this automatically.